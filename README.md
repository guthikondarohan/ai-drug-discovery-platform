# AI Drug Discovery Project

A comprehensive AI-powered platform for molecular activity prediction with ChatGPT-style interface, real-time predictions, and RDKit integration.

## üåê Web Interface

### **ChatGPT-Style Chat Interface (Recommended)**

Launch the interactive chat interface:

**Windows (PowerShell):**
```powershell
.\run_chat.ps1
```

**Or directly:**
```powershell
.\.venv\Scripts\streamlit run chat_app.py
```

Then open your browser to **http://localhost:8501**

### **Features:**
- üí¨ **ChatGPT Dark Theme** - Sleek, modern interface
- üîÆ **Real-time Predictions** - Enter SMILES notation for instant molecular activity predictions
- üìä **Multi-File Upload** - Upload multiple CSV files at once (molecular or general data)
- üß™ **Smart Detection** - Automatically detects molecular vs. general datasets
- üìà **Interactive Visualizations** - Beautiful Plotly charts and confidence gauges
- üíä **13 RDKit Descriptors** - Full chemical property analysis
- ü§ñ **AI Assistant** - Ask questions about molecular properties, LogP, SMILES notation, etc.
- üì• **Export Results** - Download predictions as CSV

### **Original Dashboard**

For the full-featured dashboard with tabs:

```powershell
.\run_app.ps1
```

Features: Single/batch predictions, model performance metrics, comprehensive documentation

---

## Project Structure

- **`data/`** ‚Äî Raw and processed datasets
  - `molecules_sample.csv` - Sample SMILES data for testing
  - `clinical_text_sample.csv` - Sample clinical notes
  - `processed/` - Train/test splits generated by preprocessing
- **`notebooks/`** ‚Äî Jupyter notebooks for exploratory data analysis
- **`src/`** ‚Äî Core Python modules:
  - `data_preprocessing.py` ‚Äî Molecular featurization with RDKit (13 descriptors)
  - `embeddings.py` ‚Äî Molecular fingerprints and text embeddings
  - `models_fixed.py` ‚Äî Neural network architectures
  - `train.py` ‚Äî Training loops with validation
  - `evaluate_fixed.py` ‚Äî Evaluation metrics and ROC plots
  - `utils.py` ‚Äî Utilities (seed setting, directory helpers)
  - `main.py` ‚Äî CLI orchestration for full pipeline
- **`scripts/`** ‚Äî Convenience wrappers (PowerShell and Bash)
- **`results/`** ‚Äî Model outputs, metrics, plots
- **`app.py`** ‚Äî Full-featured Streamlit dashboard
- **`chat_app.py`** ‚Äî ChatGPT-style chat interface ‚≠ê
- **`run_chat.ps1`** ‚Äî Quick launcher for chat interface

## Getting Started

### 1. Create a Python environment and install dependencies

**Option A: pip (includes RDKit)**
```powershell
python -m venv .venv
.\.venv\Scripts\Activate.ps1
pip install --upgrade pip
pip install -r requirements.txt
```

**Option B: Conda (alternative for RDKit)**
```powershell
conda create -n ai_dd python=3.11 -y
conda activate ai_dd
conda install -c conda-forge rdkit -y
pip install -r requirements.txt
```

### 2. Train the model

**PowerShell (Windows):**
```powershell
.\.venv\Scripts\python -m src.main --stage all --epochs 10
```

**Bash (Unix/WSL):**
```bash
python -m src.main --stage all --epochs 10
# or use wrapper script
./scripts/run_training.sh
```

This will:
- Preprocess molecular data (13 RDKit descriptors)
- Split into train/test sets
- Train neural network classifier
- Save model to `results/model.pt`

### 3. Launch the Chat Interface

```powershell
.\run_chat.ps1
```

Open http://localhost:8501 and start chatting!

The project now includes **full RDKit support** with 13 molecular descriptors:

1. **MolWt** - Molecular weight
2. **LogP** - Lipophilicity (octanol/water partition coefficient)
3. **NumHDonors** - Hydrogen bond donors
4. **NumHAcceptors** - Hydrogen bond acceptors
5. **TPSA** - Topological polar surface area
6. **NumRotatableBonds** - Molecular flexibility
7. **NumAromaticRings** - Aromatic ring count
8. **NumAliphaticRings** - Non-aromatic rings
9. **NumSaturatedRings** - Fully saturated rings
10. **NumHeteroatoms** - Non-carbon/hydrogen atoms
11. **RingCount** - Total ring systems
12. **FractionCsp3** - Saturation fraction
13. **NumValenceElectrons** - Electronic properties

If RDKit is not available, the system falls back to simple string-based features.

## üìä Features

- ‚úÖ **13 RDKit Molecular Descriptors** - Full chemical property analysis
- ‚úÖ **ChatGPT-Style Interface** - Modern, intuitive chat UI
- ‚úÖ **Multi-File Upload** - Process multiple datasets simultaneously
- ‚úÖ **Smart Dataset Detection** - Auto-detects molecular vs. general data
- ‚úÖ **Real-Time Predictions** - Instant SMILES analysis
- ‚úÖ **Interactive Visualizations** - Plotly charts with dark theme
- ‚úÖ **AI Assistant** - Answer questions about chemistry and drug discovery
- ‚úÖ **Export Capabilities** - Download results as CSV
- ‚úÖ **Windows Compatible** - PowerShell scripts included

## üî¨ Technical Details

**Model Architecture:**
- 3-layer feed-forward neural network
- Dropout regularization (0.2)
- BCE loss with sigmoid activation
- Adam optimizer

**Training:**
- Stratified train/test split
- Validation AUC monitoring
- Early stopping capability
- Checkpoint saving

**Data Processing:**
- RDKit molecular featurization
- SentenceTransformer text embeddings
- Pandas data manipulation
- Scikit-learn utilities
```

This will:
- Preprocess molecular data (13 RDKit descriptors)
- Split into train/test sets
- Train neural network classifier
- Save model to `results/model.pt`

### 3. Launch the Chat Interface

```powershell
.\run_chat.ps1
```

Open http://localhost:8501 and start chatting!

## üí° Usage Examples

### **Chat Interface Commands:**

**Predict single molecule:**
```
CCO
```
‚Üí Instant prediction with confidence gauge and molecular properties

**Ask questions:**
```
What is LogP?
Explain SMILES notation
Help
```

**Upload files:**
- Drag and drop multiple CSV files
- Molecular data (with 'smiles' column) ‚Üí Activity predictions
- General data ‚Üí Dataset overview and preview

**Example SMILES to try:**
- `CCO` (Ethanol)
- `CC(=O)OC1=CC=CC=C1C(=O)O` (Aspirin)
- `CN1C=NC2=C1C(=O)N(C(=O)N2C)C` (Caffeine)

### **CLI Pipeline Commands:**

**Preprocess only:**
```powershell
.\.venv\Scripts\python -m src.main --stage preprocess
```

**Train only:**
```powershell
.\.venv\Scripts\python -m src.main --stage training --epochs 10
```

**Evaluate only:**
```powershell
.\.venv\Scripts\python -m src.main --stage evaluate
```

## üìÅ Sample Data

- `data/molecules_sample.csv` ‚Äî 10 sample SMILES molecules with labels
- `data/clinical_text_sample.csv` ‚Äî 3 sample clinical notes

Replace with your real datasets when ready. The system auto-detects full datasets or falls back to samples.

## üöÄ Next Steps

- Replace sample data with curated molecular datasets
- Add unit tests in `tests/` directory
- Integrate experiment logging (wandb/mlflow)
- Create `configs/` for hyperparameter management
- Train on larger datasets for production use
- Add LICENSE file

## üìö Resources

- [RDKit Documentation](https://www.rdkit.org/docs/)
- [SMILES Tutorial](http://www.daylight.com/dayhtml/doc/theory/theory.smiles.html)
- [Streamlit Documentation](https://docs.streamlit.io/)
- [PyTorch Documentation](https://pytorch.org/docs/)

---

**Version:** 1.0.0 | **Built with:** Python, PyTorch, RDKit, Streamlit, Plotly
